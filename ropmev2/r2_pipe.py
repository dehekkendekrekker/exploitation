import sys
import r2pipe

r = r2pipe.open()

# Setup breakpoints
r.cmd("db 0x40116b")

# Setup labels
r.cmd("f label.process_input @ 0x401238")
r.cmd("f label.prep_output_buffer @ 0x401213")
r.cmd("db 0x00401202") #just before ROP
r.cmd("dc")
r.cmd("dc")
r.cmd("dc")
r.cmd("dc")

r.cmd("dso 3")
r.cmd("ds 4")
r.cmd("ds 3")
r.cmd("ds")
r.cmd("dcr")
r.cmd("ds")

r.cmd("ds 8")

# Enter read
r.cmd("s")
r.cmd("dcr")
r.cmd("s")

r.cmd("s 9")

#Enter execve
